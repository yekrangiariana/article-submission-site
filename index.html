<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Submission Site</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css?v=20260221" />
  </head>
  <body>
    <header>
      <img src="logo.png" alt="Essential Stories" class="header-logo" />
      <h1 id="site-mode-title">Submission Site</h1>
      <div class="mode-switch-wrap">
        <div class="mode-switch-label">Submission Mode</div>
        <div class="mode-switch" aria-label="Submission mode">
          <button type="button" class="mode-btn active" id="mode-general-btn">
            <span class="mode-name">Submission Site</span>
            <span class="mode-desc">For regular article submissions</span>
          </button>
          <button type="button" class="mode-btn" id="mode-essentials-btn">
            <span class="mode-name">Essentials Stories</span>
            <span class="mode-desc">For weekly essentials stories</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Progress -->
    <div class="progress-wrap">
      <div class="progress-labels" id="progressLabels"></div>
    </div>

    <!-- Card -->
    <div class="card">
      <!-- ── Step 1: Title & Description ── -->
      <div class="step active" id="step-1">
        <div class="step-header">
          <div class="step-badge">Step 1 of 6</div>
          <div class="step-title">Headline &amp; Summary</div>
          <div class="step-desc">
            Set the core editorial metadata: a clear headline and a concise
            summary for readers and search.
          </div>
        </div>

        <div class="field">
          <label for="title">Headline <span class="req">*</span></label>
          <input
            type="text"
            id="title"
            placeholder="Is the ceasefire already collapsing?"
            autocomplete="off"
          />
          <div class="field-error" id="title-err">Please enter a headline.</div>
        </div>

        <div class="field">
          <label for="description">Summary <span class="req">*</span></label>
          <textarea
            id="description"
            placeholder="Three NATO member states requested an emergency summit after satellite imagery showed major troop movements within 40km of the border."
            style="min-height: 100px"
          ></textarea>
          <div class="field-error" id="desc-err">Please add a summary.</div>
        </div>

        <input type="hidden" id="slug" />

        <div class="field">
          <div class="mode-general-only">
            <label for="author"
              >Author(s) <span class="req">*</span>
              <span class="hint"
                >Enter multiple authors as a comma-separated list.</span
              ></label
            >
            <input
              type="text"
              id="author"
              placeholder="Ariana Yekrangi, Adrian Liberto"
              autocomplete="off"
            />
            <div class="field-error" id="author-err">
              Please enter at least one author.
            </div>
          </div>
        </div>

        <div class="field">
          <label for="dateField"
            >Publication Date
            <span class="hint">Pre-filled with the current date and time.</span>
          </label>
          <input type="datetime-local" id="dateField" />
        </div>

        <div class="nav-row">
          <div></div>
          <button class="btn btn-primary" id="step1-next-btn" onclick="goTo(2)">
            Next → Country &amp; Taxonomy
          </button>
        </div>
      </div>

      <!-- ── Step 2: Country ── -->
      <div class="step" id="step-2">
        <div class="step-header">
          <div class="step-badge">Step 2 of 6</div>
          <div class="step-title" id="step2-title">Country &amp; Taxonomy</div>
          <div class="step-desc" id="step2-desc">
            Add country context and taxonomy metadata so the article can be
            grouped and discovered correctly.
          </div>
        </div>

        <div class="field">
          <p class="toggle-prompt">Is this story primarily about a country?</p>
          <div class="yes-no-wrap" id="countrySelect">
            <button
              type="button"
              class="yes-no-btn"
              onclick="setHasCountry(true)"
            >
              Yes
            </button>
            <button
              type="button"
              class="yes-no-btn"
              onclick="setHasCountry(false)"
            >
              No
            </button>
          </div>
          <input type="hidden" id="hasCountry" />
        </div>

        <div class="collapsible" id="countrySection">
          <div class="field" style="margin-top: 14px">
            <label for="countryName"
              >Countries <span class="req">*</span>
              <span class="hint"
                >Enter multiple countries as comma-separated values (Sudan,
                Ukraine)</span
              >
            </label>
            <input
              type="text"
              id="countryName"
              placeholder="Sudan, Ukraine, Yemen"
              autocomplete="off"
            />
            <div class="field-error" id="country-err">
              Please enter at least one country.
            </div>
          </div>
        </div>

        <div class="mode-general-only">
          <div class="field" style="margin-top: 14px">
            <label for="generalCategories"
              >Categories
              <span class="hint"
                >Comma-separated values (Human Rights, Technology)</span
              ></label
            >
            <input
              type="text"
              id="generalCategories"
              placeholder="Human Rights, Policy"
              autocomplete="off"
            />
          </div>

          <div class="field">
            <label for="generalTags"
              >Tags
              <span class="hint"
                >Comma-separated values (United States, UN Security
                Council)</span
              ></label
            >
            <input
              type="text"
              id="generalTags"
              placeholder="United States, Diplomacy"
              autocomplete="off"
            />
          </div>
        </div>

        <div class="nav-row">
          <button class="btn btn-ghost" onclick="goTo(1)">← Back</button>
          <button class="btn btn-primary" onclick="goTo(3)">
            Next → Article Draft
          </button>
        </div>
      </div>

      <!-- ── Step 3: Post Content ── -->
      <div class="step" id="step-3">
        <div class="step-header">
          <div class="step-badge">Step 3 of 6</div>
          <div class="step-title">Article Draft</div>
          <div class="step-desc">
            Write or paste the full article body in markdown format.
          </div>
        </div>

        <div class="field">
          <label for="content">Article Body <span class="req">*</span></label>
          <textarea
            id="content"
            class="tall"
            placeholder="Write or paste the full article here.&#10;&#10;Use markdown for structure and emphasis: ## headings, **bold**, *italic*, and links."
          ></textarea>
          <div class="field-error" id="content-err">
            Please add the article body.
          </div>
        </div>

        <div class="nav-row">
          <button class="btn btn-ghost" onclick="goTo(2)">← Back</button>
          <button class="btn btn-primary" id="step3-next-btn" onclick="goTo(4)">
            Next → Quotes
          </button>
        </div>
      </div>

      <!-- ── Step 4: Quotes ── -->
      <div class="step" id="step-4">
        <div class="step-header">
          <div class="step-badge">Step 4 of 6</div>
          <div class="step-title">Highlighted Quotes</div>
          <div class="step-desc">
            Add optional pull quotes that reinforce the core narrative.
          </div>
        </div>

        <div class="field">
          <p class="toggle-prompt">
            Would you like to include highlighted quotes?
          </p>
          <div class="yes-no-wrap" id="quotesSelect">
            <button
              type="button"
              class="yes-no-btn"
              onclick="setHasQuotes(true)"
            >
              Yes
            </button>
            <button
              type="button"
              class="yes-no-btn"
              onclick="setHasQuotes(false)"
            >
              No
            </button>
          </div>
          <input type="hidden" id="hasQuotes" />
        </div>

        <div class="collapsible" id="quotesSection">
          <div style="margin-top: 14px">
            <div class="item-list" id="quoteList"></div>
            <button type="button" class="add-btn" onclick="addQuote()">
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="3"
              >
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
              </svg>
              Add another quote
            </button>
          </div>
        </div>

        <div class="nav-row">
          <button class="btn btn-ghost" onclick="goTo(3)">← Back</button>
          <button class="btn btn-primary" onclick="goTo(5)">Next → Quiz</button>
        </div>
      </div>

      <!-- ── Step 5: Quiz ── -->
      <div class="step" id="step-5">
        <div class="step-header">
          <div class="step-badge">Step 5 of 6</div>
          <div class="step-title">Quiz</div>
          <div class="step-desc">
            Add an optional, fact-based quiz only when the article clearly
            supports it. Each question must be self-contained and make sense on
            its own.
          </div>
        </div>

        <div class="field">
          <p class="toggle-prompt">Would you like to include a quiz?</p>
          <div class="yes-no-wrap" id="quizSelect">
            <button type="button" class="yes-no-btn" onclick="setHasQuiz(true)">
              Yes
            </button>
            <button
              type="button"
              class="yes-no-btn"
              onclick="setHasQuiz(false)"
            >
              No
            </button>
          </div>
          <input type="hidden" id="hasQuiz" />
        </div>

        <div class="collapsible" id="quizSection">
          <div style="margin-top: 14px">
            <div class="item-list" id="quizList"></div>
            <button type="button" class="add-btn" onclick="addQuestion()">
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="3"
              >
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
              </svg>
              Add another question
            </button>
          </div>
        </div>

        <div class="nav-row">
          <button class="btn btn-ghost" onclick="goTo(4)">← Back</button>
          <button class="btn btn-primary" onclick="goTo(6)">
            Next → Review &amp; Send
          </button>
        </div>
      </div>

      <!-- ── Step 6: Review & Send ── -->
      <div class="step" id="step-6">
        <div class="step-header">
          <div class="step-badge">Step 6 of 6</div>
          <div class="step-title">Review &amp; Send</div>
          <div class="step-desc">
            Review the generated markdown, then export or send.
          </div>
        </div>

        <div class="tv-monitor">
          <div class="tv-screen">
            <div class="output-block" id="outputBlock"></div>

            <!-- Action Popup inside TV -->
            <div id="actionModal" class="tv-checklist" style="display: none">
              <div class="tv-checklist-header">
                <h2 id="actionModalTitle">Submission Status</h2>
                <button
                  type="button"
                  class="tv-close"
                  onclick="closeActionModal()"
                >
                  ×
                </button>
              </div>
              <div class="tv-checklist-body" id="actionModalBody">
                <div class="tv-action-message"></div>
              </div>
            </div>
          </div>
          <div class="tv-controls">
            <button
              class="tv-btn"
              onclick="copyOutput()"
              title="Copy markdown to clipboard"
            >
              <svg
                width="12"
                height="12"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"
                />
                <path
                  d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"
                />
              </svg>
              COPY
            </button>
            <button
              class="tv-btn"
              onclick="sendEmail()"
              title="Open email client with draft"
            >
              <svg
                width="12"
                height="12"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.105V5.383zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741zM1 11.105l4.708-2.897L1 5.383v5.722z"
                />
              </svg>
              EMAIL
            </button>

            <button
              class="tv-btn tv-btn-danger"
              onclick="resetForm()"
              title="Reset form and start over"
            >
              <svg
                width="12"
                height="12"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"
                />
                <path
                  d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"
                />
              </svg>
              RESET
            </button>
            <button
              class="tv-btn tv-btn-submit"
              onclick="openSubmitModal()"
              title="Submit article to GitHub"
            >
              <svg
                width="12"
                height="12"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
                />
              </svg>
              SUBMIT
            </button>
          </div>
          <div class="tv-stand"></div>
        </div>

        <div class="nav-row" style="margin-top: 16px">
          <button class="btn btn-ghost" id="step6-back-btn" onclick="goTo(5)">
            ← Back
          </button>
          <div></div>
        </div>
      </div>
    </div>
    <!-- /card -->

    <div id="toast">Copied!</div>

    <!-- Submit Modal -->
    <div id="submitModal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Submit Article</h2>
          <button
            type="button"
            class="modal-close"
            onclick="closeSubmitModal()"
          >
            ×
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-desc">
            Your article will be submitted for editorial review. Once approved,
            it will be published to the site.
          </p>

          <div id="submit-github">
            <p class="github-info">
              Submit directly via GitHub to track your contribution. Your
              submission will create an issue in the repository that editors can
              review and convert to a pull request.
            </p>
            <button class="btn btn-github btn-full" onclick="submitViaGitHub()">
              <svg
                width="16"
                height="16"
                fill="currentColor"
                viewBox="0 0 16 16"
                style="margin-right: 8px"
              >
                <path
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
                />
              </svg>
              Open GitHub Issue
            </button>
            <p class="github-note">
              You'll be redirected to GitHub to create an issue. A GitHub
              account is required.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay" style="display: none">
      <div class="modal-content modal-success">
        <div class="success-icon">✓</div>
        <h2>Submission Received!</h2>
        <p>Your article has been submitted for editorial review.</p>
        <p class="success-detail" id="success-detail"></p>
        <div class="success-actions">
          <button class="btn btn-primary" onclick="closeSuccessModal()">
            Submit Another
          </button>
          <a
            class="btn btn-ghost"
            id="view-submission-link"
            href="#"
            target="_blank"
            >View Submission →</a
          >
        </div>
      </div>
    </div>

    <script src="app.js?v=20260221"></script>
  </body>
</html>
